<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizzazione Dinamica - Trasformata di Fourier</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Visualizzazione della Soluzione dell'Equazione di Diffusione</h1>
    <p>
        Il grafico seguente rappresenta l'evoluzione temporale della funzione \( u(x,t) \) calcolata come convoluzione del nucleo di calore \( G(x,t) \) e una distribuzione iniziale \( u_0(x) \).
    </p>
    
    <div>
        <canvas id="heatEquationChart" width="800" height="400"></canvas>
    </div>

    <div>
        <label for="timeSlider">Seleziona il tempo \( t \):</label>
        <input type="range" id="timeSlider" min="0.1" max="5" step="0.1" value="0.1" oninput="updateTime(this.value)">
        <span id="timeValue">0.1</span>
    </div>

    <div>
        <button onclick="startAnimation()">Avvia</button>
        <button onclick="pauseAnimation()">Pausa</button>
    </div>

    <script>
        const ctx = document.getElementById('heatEquationChart').getContext('2d');
        const initialCondition = (x) => Math.exp(-x * x); // u_0(x)
        const heatKernel = (x, t) => (1 / Math.sqrt(4 * Math.PI * t)) * Math.exp(-x * x / (4 * t));

        let time = 0.1; // Tempo iniziale
        let animationFrame;
        let isAnimating = false;

        const computeSolution = (x, t) => {
            const dx = 0.1;
            let integral = 0;
            for (let xi = -10; xi <= 10; xi += dx) {
                integral += heatKernel(x - xi, t) * initialCondition(xi) * dx;
            }
            return integral;
        };

        const generateData = (t) => {
            const xValues = Array.from({ length: 201 }, (_, i) => -10 + i * 0.1);
            const uValues = xValues.map(x => computeSolution(x, t));
            return { xValues, uValues };
        };

        const initialData = generateData(time);

        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: initialData.xValues,
                datasets: [{
                    label: `u(x, t=${time.toFixed(1)})`,
                    data: initialData.uValues,
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2,
                    fill: false,
                }],
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        type: 'linear',
                        title: {
                            display: true,
                            text: 'x'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'u(x, t)'
                        }
                    }
                }
            }
        });

        const updateChart = (t) => {
            const newData = generateData(t);
            chart.data.labels = newData.xValues;
            chart.data.datasets[0].data = newData.uValues;
            chart.data.datasets[0].label = `u(x, t=${t.toFixed(1)})`;
            chart.update();
        };

        const updateTime = (newTime) => {
            time = parseFloat(newTime);
            document.getElementById('timeValue').textContent = newTime;
            updateChart(time);
        };

        const animate = () => {
            if (time >= 5) time = 0.1; // Riparti da capo
            time += 0.1;
            document.getElementById('timeSlider').value = time;
            document.getElementById('timeValue').textContent = time.toFixed(1);
            updateChart(time);
            animationFrame = requestAnimationFrame(animate);
        };

        const startAnimation = () => {
            if (!isAnimating) {
                isAnimating = true;
                animate();
            }
        };

        const pauseAnimation = () => {
            isAnimating = false;
            cancelAnimationFrame(animationFrame);
        };
    </script>
</body>
</html>


