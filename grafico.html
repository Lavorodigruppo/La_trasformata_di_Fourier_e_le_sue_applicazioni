<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizzazione Nucleo del Calore</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h2>Visualizzazione del Nucleo del Calore</h2>

    <!-- Canvas per il grafico -->
    <canvas id="heatKernelChart" width="800" height="400"></canvas>

    <!-- Slider per il tempo -->
    <div>
        <label for="timeSlider">Tempo (t): </label>
        <input type="range" id="timeSlider" min="0.1" max="5" step="0.1" value="1">
        <span id="timeValue">1</span>
    </div>

    <!-- Script per il grafico e l'interattivitÃ  -->
    <script>
        const alpha = 1; // Coefficiente di diffusione

        // Funzione del nucleo del calore
        function heatKernel(x, t) {
            return (1 / (2 * alpha * Math.sqrt(Math.PI * t))) * Math.exp(-x * x / (4 * alpha * alpha * t));
        }

        // Curva iniziale u0(x)
        function initialCondition(x) {
            return Math.exp(-x * x); // Esempio: una gaussiana
        }

        // Convoluzione u(x, t) = integrazione numerica
        function convolve(x, t) {
            const dx = 0.1;
            let result = 0;
            for (let xi = -10; xi <= 10; xi += dx) {
                result += initialCondition(xi) * heatKernel(x - xi, t) * dx;
            }
            return result;
        }

        // Generazione dei dati per il grafico
        function generateData(t) {
            const xValues = [];
            const gValues = [];
            const uValues = [];
            for (let x = -10; x <= 10; x += 0.1) {
                xValues.push(x);
                gValues.push(heatKernel(x, t));
                uValues.push(convolve(x, t));
            }
            return { xValues, gValues, uValues };
        }

        // Creazione del grafico
        const ctx = document.getElementById('heatKernelChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    {
                        label: 'Nucleo del Calore G(x, t)',
                        data: [],
                        borderColor: 'blue',
                        fill: false,
                    },
                    {
                        label: 'Curva Evoluta u(x, t)',
                        data: [],
                        borderColor: 'red',
                        fill: false,
                    },
                ],
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        type: 'linear',
                        title: { display: true, text: 'x' },
                    },
                    y: {
                        title: { display: true, text: 'Valore' },
                    },
                },
            },
        });

        // Funzione per aggiornare il grafico
        function updateChart(t) {
            const { xValues, gValues, uValues } = generateData(t);
            chart.data.labels = xValues;
            chart.data.datasets[0].data = gValues;
            chart.data.datasets[1].data = uValues;
            chart.update();
        }

        // Slider interattivo
        const timeSlider = document.getElementById('timeSlider');
        const timeValue = document.getElementById('timeValue');
        timeSlider.addEventListener('input', (e) => {
            const t = parseFloat(e.target.value);
            timeValue.textContent = t;
            updateChart(t);
        });

        // Animazione automatica
        let t = 0.1;
        function animate() {
            t += 0.1;
            if (t > 5) t = 0.1;
            timeSlider.value = t;
            timeValue.textContent = t.toFixed(1);
            updateChart(t);
            requestAnimationFrame(animate);
        }

        // Avvia l'animazione e inizializza il grafico
        updateChart(1); // Stato iniziale
        animate();
    </script>
</body>
</html>

